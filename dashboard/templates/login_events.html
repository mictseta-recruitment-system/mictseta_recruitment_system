{% extends 'dashboard_base.html' %}

{% block title %}Audit|Login Events{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
	<ol class="breadcrumb">
		<li class="breadcrumb-item active" aria-current="page"><i class="fa-solid fa-check"></i>Aduit Log</li>
		<li class="breadcrumb-item active" aria-current="page"><i class="fa-solid fa-user-shield"></i>Login Events</li>
    </ol>
	</nav>  
     {% endblock %}

{% load static %}
<style>
	.breadcrumb {
   display: flex;
   list-style: none;
   padding: 0;
   margin: 0;
   background-color: #f8f9fa;
   border-radius: 0.25rem;
  }
  
  .breadcrumb-item {
   display: flex;
   align-items: center;
  }
  
  .breadcrumb-item + .breadcrumb-item {
   padding-left: 0.5rem;
  }
  
  .breadcrumb-item + .breadcrumb-item::before {
   display: inline-block;
   padding-right: 0.5rem;
   color: #6c757d;
   content: "/";
  }
  
  .breadcrumb-item a {
   text-decoration: none;
   color: #007bff;
  }
  
  .breadcrumb-item.active {
   color: #6c757d;
  }
  
  .btn.btn-outline {
   display: inline-flex;
   align-items: center;
   padding: 0.375rem 0.75rem;
   font-size: 1rem;
   line-height: 1.5;
   border: 1px solid transparent;
   border-radius: 0.25rem;
   transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
  }
  
  .btn.btn-outline:hover {
   color: #fff;
   background-color: #007bff;
   border-color: #007bff;
  }
  
  .breadcrumb-item i {
   margin-right: 0.5rem;
  }
	 </style>

{% block content %}
<div class="table-container mt-3" >
 <div class="card shadow-lg rounded">
    <div class="card-header d-flex justify-content-between " >

        <h6>Login Events List</h6> 

         <a href="{% url 'dashboard.login_events_generate_pdf_report' %}" class="btn btn-warning py-0" style=""><i class="fa fa-bar-chart" aria-hidden="true"></i> Generate report </a> 

    </div>
              


    <div class="card-body" style="overflow-x: scroll;"> 
		<table id="login_events" class="table table-striped table-hover" style="width:100%">
	        <thead>
	            <tr>
	                <th>Date</th>
	                <th>Method</th>
	                <th>User </th>
	                <th>User Email</th>
	                <th>Remote IP</th>
	                
	            </tr>
	        </thead>
	        <tbody>
	        	{% for login_event in login_events %}

	        	<tr>
	                <td>{{login_event.date }}</td>

	                <td>
	                	{% if login_event.method == "LOGIN" %}
		                	<button type="text" class="btn btn-primary p-0 " disabled> 
		                		{{ login_event.method }}
		                	</button>
	                	{% elif login_event.method == "LOGOUT" %}
		                	<button type="text" class="btn btn-info p-0" disabled> 
		                		{{ login_event.method }}
		                	</button>
	                	{% else %}
	                		<button type="text" class="btn btn-danger p-0" disabled> 
		                		{{ login_event.method }}
		                	</button>
		                {% endif %}
	            	</td>
	                {% if login_event.user != "ANONYMOUS" %}
	                <td>{{ login_event.user.first_name }} {{ login_event.user.last_name }}</td>
	                <td>{{ login_event.user.email }}</td>
	                {% else %}
	                <td>{{ login_event.user }}</td>
	                <td>{{ login_event.user }}</td>
	                {% endif %}
	                <td>{{ login_event.remote_ip }}</td>
	                
	            </tr>
	           {% endfor %}

	        </tbody>
	        <tfoot>
	            <tr>
	                <th>Date</th>
	                <th>Method</th>
	                <th>User </th>
	                <th>User Email</th>
	                <th>Remote IP</th>
	            </tr>
	        </tfoot>
	    </table>
	</div>
</div>
     <script >
              
              $(document).ready(function (){

                new DataTable('#login_events');

              });

     </script>
</div>
{% endblock %}